{"remainingRequest":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/node_modules/babel-loader/lib/index.js!/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/src/api/utils.js","dependencies":[{"path":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/src/api/utils.js","mtime":1592508303810},{"path":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9ob21lL2hhYjA3L0Rlc2t0b3AvUmVwby1Qcm95ZWN0by9QUk9ZRUNUTy9Gcm9udGVuZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCBqd3QgZnJvbSAiand0LWRlY29kZSI7CnZhciBFTkRQT0lOVCA9ICJodHRwOi8vbG9jYWxob3N0OjMwMDMiOwp2YXIgQVVUSF9UT0tFTl9LRVkgPSAiYXV0aFRva2VuIjsKdmFyIFJPTEUgPSAicm9sZSI7CnZhciBVU0VSID0gInVzZXIiOwpleHBvcnQgZnVuY3Rpb24gc2luZ0luVXNlcihtYWlsLCBjb250cmFzZW5oYSkgewogIHJldHVybiBuZXcgUHJvbWlzZSggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKHJlc29sdmUsIHJlamVjdCkgewogICAgICB2YXIgcmVzOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDA7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIGF4aW9zKHsKICAgICAgICAgICAgICAgIHVybDogIiIuY29uY2F0KEVORFBPSU5ULCAiL3VzdWFyaW9zL2xvZ2luIiksCiAgICAgICAgICAgICAgICAvL1VSTCBERSBMQSBBVVRFTlRJQ0FDScOTTgogICAgICAgICAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgICAgICAgICAvL03DiVRPRE8gREUgTEEgQVVURU5USUNBQ0nDk04KICAgICAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgICAgLy9EQVRPUyBERSBMQSBBVVRFTlRJQ0FDScOTTgogICAgICAgICAgICAgICAgICBtYWlsOiBtYWlsLAogICAgICAgICAgICAgICAgICAvL1VTVUFSSW8KICAgICAgICAgICAgICAgICAgY29udHJhc2VuaGE6IGNvbnRyYXNlbmhhLAogICAgICAgICAgICAgICAgICAvL1BBU1NXT1JECiAgICAgICAgICAgICAgICAgIGdyYW50X3R5cGU6ICJwYXNzd29yZCIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICByZXMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgIHNldEF1dGhUb2tlbihyZXMuZGF0YS50b2tlbik7CiAgICAgICAgICAgICAgc2V0SXNBZG1pbihyZXMuZGF0YS5hZG1pbik7IC8vYXF1w60gc2V0CgogICAgICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDk7CiAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgwKTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRXJyb3IgZW4gbG9naW46ICIsIF9jb250ZXh0LnQwKTsKICAgICAgICAgICAgICByZWplY3QoX2NvbnRleHQudDApOwoKICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSwgbnVsbCwgW1swLCA5XV0pOwogICAgfSkpOwoKICAgIHJldHVybiBmdW5jdGlvbiAoX3gsIF94MikgewogICAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfTsKICB9KCkpOwp9IC8vR1VBUkRBUiBUT0tFTiBFTiBMT0NBTFNUT1JBR0UKCmV4cG9ydCBmdW5jdGlvbiBzZXRBdXRoVG9rZW4odG9rZW4pIHsKICBheGlvcy5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsiYXV0aG9yaXphdGlvbiJdID0gIkJlYXJlciAiLmNvbmNhdCh0b2tlbik7CiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oQVVUSF9UT0tFTl9LRVksIHRva2VuKTsKfSAvL0ZVTkNJw5NOIERFIExPR09VVAoKZXhwb3J0IGZ1bmN0aW9uIGNsZWFyTG9naW4oKSB7CiAgYXhpb3MuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bIkF1dGhvcml6YXRpb24iXSA9ICIiOwogIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCJ0b2tlbiIpOwogIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCJpZCIpOwogIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCJyb2wiKTsKICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgibWFpbCIpOwogIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCJuYW1lIik7CiAgY2xlYXJBZG1pbigpOwp9IC8vIENPR0VSIEVMIFRPS0VOIERFTCBMT0NBTFNUT1JBR0UKCmV4cG9ydCBmdW5jdGlvbiBnZXRBdXRoVG9rZW4oKSB7CiAgcmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKEFVVEhfVE9LRU5fS0VZKTsKfSAvL0NPTlNJR1VJRU5URSBMQSBGRUNIQSBERSBFWFBJUkFDScOTTiBERUwgVE9LRU4KCmV4cG9ydCBmdW5jdGlvbiBnZXRUb2tlbkV4cGlyYXRpb25EYXRlKGVuY29kZWRUb2tlbikgewogIHZhciB0b2tlbiA9IGp3dChlbmNvZGVkVG9rZW4pOyAvLyBTSSBOTyBIQVksIE5PIFNJR1VFCgogIGlmICghdG9rZW4uZXhwKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CgogIHZhciBkYXRlID0gbmV3IERhdGUoMCk7CiAgZGF0ZS5zZXRVVENTZWNvbmRzKHRva2VuLmV4cCk7CiAgcmV0dXJuIGRhdGU7Cn0gLy9DT01QUk9CQU5ETyBWSUdFTkNJQSBERSBMQSBGRUNIQQoKZXhwb3J0IGZ1bmN0aW9uIGlzVG9rZW5FeHBpcmVkKHRva2VuKSB7CiAgdmFyIGV4cGlyYXRpb25EYXRlID0gZ2V0VG9rZW5FeHBpcmF0aW9uRGF0ZSh0b2tlbik7CiAgcmV0dXJuIGV4cGlyYXRpb25EYXRlIDwgbmV3IERhdGUoKTsKfSAvL0NPTVBST0JBUiBTSSBFTCBVU0VSIEVTVMOBIExPR0VBRE8gTyBOTwoKZXhwb3J0IGZ1bmN0aW9uIGlzTG9nZ2VkSW4oKSB7CiAgdmFyIGF1dGhUb2tlbiA9IGdldEF1dGhUb2tlbigpOwogIHJldHVybiAhIWF1dGhUb2tlbiAmJiAhaXNUb2tlbkV4cGlyZWQoYXV0aFRva2VuKTsKfSAvL0ZVTkNJT05FUyBQQVJBIENPTVBST0JBUiBFTCBST0wgREVMIFVTRVIgPT09PT09PT09PT0KLy9HVUFSREFSIFNJIEVTIEFETUlOIEVOIExPQ0FMIFNUT1JBR0UKCmV4cG9ydCBmdW5jdGlvbiBzZXRJc0FkbWluKGFkbWluKSB7CiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oUk9MRSwgYWRtaW4pOwp9IC8vQk9SUkFSIFJPTCBERUwgVVNFUiBFTiBMT0NBTCBTVE9SQUdFCgpleHBvcnQgZnVuY3Rpb24gY2xlYXJBZG1pbigpIHsKICByZXR1cm4gbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oUk9MRSk7Cn0gLy9SRUNVUEVSQVIgRUwgUk9MIEdVQVJEQURPIEVOIEVMIExPQ0FMIFNUT1JBR0UKCmV4cG9ydCBmdW5jdGlvbiBnZXRJc0FkbWluKCkgewogIHJldHVybiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShST0xFKTsKfSAvL0NPTVBST0JBUiBST0wKCmV4cG9ydCBmdW5jdGlvbiBjaGVja0FkbWluKCkgewogIHZhciByb2xlID0gZmFsc2U7CiAgdmFyIGFkbWluID0gZ2V0SXNBZG1pbigpOwoKICBpZiAoYWRtaW4gPT09ICJhZG1pbiIpIHsKICAgIHJvbGUgPSB0cnVlOwogIH0gZWxzZSB7CiAgICByb2xlID0gZmFsc2U7CiAgfQoKICByZXR1cm4gcm9sZTsKfSAvLyBFc3RhIGZ1bmNpw7NuIG5vIGxhIHV0aWxpem8sIGxhIHRlbmdvIGVuIGJhcmJlY2hvIHBvcnF1ZSBlc3RhYmEgdHJhdGFuZG8KLy8gZGUgc2FjYXIgZWwgbm9tYnJlIGRlbCB1c3VhcmlvIGFjdGl2byBlbiBlbCBtZW7DuiBkZSBuYXZlZ2FjacOzbi4KCmV4cG9ydCBmdW5jdGlvbiBnZXRVc2VyQWN0aXZlKCkgewogIHJldHVybiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShVU0VSKTsKfQ=="},{"version":3,"sources":["/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/src/api/utils.js"],"names":["axios","jwt","ENDPOINT","AUTH_TOKEN_KEY","ROLE","USER","singInUser","mail","contrasenha","Promise","resolve","reject","url","method","data","grant_type","res","setAuthToken","token","setIsAdmin","admin","console","log","defaults","headers","common","localStorage","setItem","clearLogin","removeItem","clearAdmin","getAuthToken","getItem","getTokenExpirationDate","encodedToken","exp","date","Date","setUTCSeconds","isTokenExpired","expirationDate","isLoggedIn","authToken","getIsAdmin","checkAdmin","role","getUserActive"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport jwt from \"jwt-decode\";\n\nconst ENDPOINT = \"http://localhost:3003\";\nconst AUTH_TOKEN_KEY = \"authToken\";\nconst ROLE = \"role\";\nconst USER = \"user\";\n\nexport function singInUser(mail, contrasenha) {\n  return new Promise(async (resolve, reject) => {\n    try {\n      let res = await axios({\n        url: `${ENDPOINT}/usuarios/login`, //URL DE LA AUTENTICACIÓN\n        method: \"POST\", //MÉTODO DE LA AUTENTICACIÓN\n        data: {\n          //DATOS DE LA AUTENTICACIÓN\n          mail: mail, //USUARIo\n          contrasenha: contrasenha, //PASSWORD\n          grant_type: \"password\",\n        },\n      });\n      setAuthToken(res.data.token);\n      setIsAdmin(res.data.admin); //aquí set\n\n      resolve();\n    } catch (err) {\n      console.log(\"Error en login: \", err);\n      reject(err);\n    }\n  });\n}\n\n//GUARDAR TOKEN EN LOCALSTORAGE\n\nexport function setAuthToken(token) {\n  axios.defaults.headers.common[\"authorization\"] = `Bearer ${token}`;\n  localStorage.setItem(AUTH_TOKEN_KEY, token);\n}\n\n//FUNCIÓN DE LOGOUT\n\nexport function clearLogin() {\n  axios.defaults.headers.common[\"Authorization\"] = \"\";\n  localStorage.removeItem(\"token\");\n  localStorage.removeItem(\"id\");\n  localStorage.removeItem(\"rol\");\n  localStorage.removeItem(\"mail\");\n  localStorage.removeItem(\"name\");\n  clearAdmin();\n}\n\n// COGER EL TOKEN DEL LOCALSTORAGE\n\nexport function getAuthToken() {\n  return localStorage.getItem(AUTH_TOKEN_KEY);\n}\n\n//CONSIGUIENTE LA FECHA DE EXPIRACIÓN DEL TOKEN\n\nexport function getTokenExpirationDate(encodedToken) {\n  let token = jwt(encodedToken);\n  // SI NO HAY, NO SIGUE\n  if (!token.exp) {\n    return null;\n  }\n\n  let date = new Date(0);\n  date.setUTCSeconds(token.exp);\n  return date;\n}\n\n//COMPROBANDO VIGENCIA DE LA FECHA\n\nexport function isTokenExpired(token) {\n  let expirationDate = getTokenExpirationDate(token);\n  return expirationDate < new Date();\n}\n\n//COMPROBAR SI EL USER ESTÁ LOGEADO O NO\n\nexport function isLoggedIn() {\n  let authToken = getAuthToken();\n  return !!authToken && !isTokenExpired(authToken);\n}\n\n//FUNCIONES PARA COMPROBAR EL ROL DEL USER ===========\n\n//GUARDAR SI ES ADMIN EN LOCAL STORAGE\n\nexport function setIsAdmin(admin) {\n  localStorage.setItem(ROLE, admin);\n}\n\n//BORRAR ROL DEL USER EN LOCAL STORAGE\n\nexport function clearAdmin() {\n  return localStorage.removeItem(ROLE);\n}\n\n//RECUPERAR EL ROL GUARDADO EN EL LOCAL STORAGE\n\nexport function getIsAdmin() {\n  return localStorage.getItem(ROLE);\n}\n\n//COMPROBAR ROL\nexport function checkAdmin() {\n  let role = false;\n  let admin = getIsAdmin();\n  if (admin === \"admin\") {\n    role = true;\n  } else {\n    role = false;\n  }\n  return role;\n}\n\n// Esta función no la utilizo, la tengo en barbecho porque estaba tratando\n// de sacar el nombre del usuario activo en el menú de navegación.\nexport function getUserActive() {\n  return localStorage.getItem(USER);\n}\n"]}]}