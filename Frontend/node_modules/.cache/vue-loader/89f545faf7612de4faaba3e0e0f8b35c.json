{"remainingRequest":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/src/views/Profile.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/src/views/Profile.vue","mtime":1592664817002},{"path":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vRVhQT1JUQU1PUyBQQVJBCi8vTWFuZWphciB0w610dWxvcyBkZSBww6FnaW5hIGVuIHBlc3Rhw7FhIG5hdmVnYWRvcgppbXBvcnQgdnVlSGVhZGZ1bCBmcm9tICJ2dWUtaGVhZGZ1bCIKLy8gTWFuZWpvIGRlIGVuZHBvaW50cywgcGV0aWNpb25lcywgcnV0YXM6CmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7Ci8vIENvbXBvbmVudGVzIGludGVybm9zCmltcG9ydCBtZW51Y3VzdG9tIGZyb20gIkAvY29tcG9uZW50cy9NZW51Q3VzdG9tLnZ1ZSIKCgpleHBvcnQgZGVmYXVsdCB7CiAgICBuYW1lOiAiUHJvZmlsZSIsCiAgICAvLyBDb21wb25lbnRlcyBkZSBsYSB2aXN0YQogICAgY29tcG9uZW50czogeyBtZW51Y3VzdG9tLCB2dWVIZWFkZnVsfSwKICAgIGRhdGEoKXsKICAgICAgICAKICAgICAgICByZXR1cm57CiAgICAgICAgICAgIC8vIERlY2xhcmFjacOzbiBkZSB2YXJpYWJsZXMgcXVlIHZveSBhIHV0aWxpemFyIHBhcmEgcmVjb2dlciBsYSBpbmZvcm1hY2nDs24KICAgICAgICAgICAgaWQ6IG51bGwsCiAgICAgICAgICAgIHVzZXI6e30sCiAgICAgICAgICAgIG51ZXZvTm9tYnJlOiAiIiwKICAgICAgICAgICAgbnVldm9BcGVsbGlkbzogIiIsCiAgICAgICAgICAgIG51ZXZhRGVzY3JpcGNpb246IiIsCiAgICAgICAgICAgIC8vIEJvb2xlYW5vIHBhcmEgY29udHJvbGFyIGVsIHYtc2hvdyBxdWUgY29udGllbmUgZWwgZm9ybXVsYXJpbyBkZSBlZGljacOzbi4KICAgICAgICAgICAgc2VlRWRpdGFibGU6IGZhbHNlLAogICAgICAgICAgICB1cmxfZm90bzoiIiwgCiAgICAgICAgICAgIGhpc3RvcmlhbDpbXSwKICAgICAgICAgICAgY29uY3Vyc29zOltdLAoKICAgICAgICB9CiAgICB9LAoKCiAgICBtZXRob2RzOiB7IAoKICAgICAgICAvLyBGVU5DScOTTiBQQVJBIEhBQ0VSIExBIFBFVElDScOTTiBBTCBTRVJWSURPUi4KCiAgICAgICAgZ2V0RGF0YVVzZXIoKXsKICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7CiAgICAgICAgICAgIC8vIENvam8gdG9rZW4gZSBpZC4KICAgICAgICAgICAgY29uc3QgdG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidG9rZW4iKTsKICAgICAgICAgICAgY29uc3QgZGF0YSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJpZCIpOwogICAgICAgICAgICBheGlvcy5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsiQXV0aG9yaXphdGlvbiJdID0gYEJlYXJlciAke3Rva2VufWA7CiAgICAgICAgICAgCiAgICAgICAgICAgIGNvbnNvbGUubG9nKHRva2VuKTsKICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7CgogICAgICAgICAgICAvLyBQZXRpY2nDs24gZ2V0IGEgbWkgcnV0YSBkZWwgQmFjayBwYXJhIGVkaXRhciB1c3VhcmlvcywgY29uY2F0ZW5hbW9zIGVsIGlkLgogICAgICAgICAgICBheGlvcy5nZXQoImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMy91c3Vhcmlvcy8iICsgZGF0YSkKICAgICAgICAgICAgCiAgICAgICAgICAgIC50aGVuIChmdW5jdGlvbiAocmVzcG9uc2UpewogICAgICAgICAgICAgIHNlbGYuaGlzdG9yaWFsID0gcmVzcG9uc2UuZGF0YS5kYXRhOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBFbiB1c2VyIHRlbmdvIGFob3JhIGVsIGFjY2VzbyBkaXJlY3RvIGEgZXN0ZSB1c3VhcmlvIGNvbmNyZXRvLgogICAgICAgICAgICAgICBzZWxmLnVzZXIgPSByZXNwb25zZS5kYXRhLmRhdGE7CiAgICAgICAgICAgICAgIC8vIE1vbnRvIGxhIHJ1dGEgcGFyYSBwb2RlciB2aXN1YWxpemFyIGxhIGltYWdlbiBxdWUgZXN0w6EgZW4gbGEgQkJERCBjb24gdW4gbm9tYnJlIGRlIGFyY2hpdm8uCiAgICAgICAgICAgICAgIHNlbGYudXNlci51cmxfZm90bz0gImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMy9pbWFnZXMvIiArIHNlbGYudXNlci51cmxfZm90bzsKICAgICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZi51c2VyLnVybF9mb3RvKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgIAogICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHsKICAgICAgICAgICAgIGFsZXJ0KCJTb2NvcnJpIik7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yLnJlc3BvbnNlLmRhdGEubWVzc2FnZSk7IAogICAgICAgICAgICAKICAgICAgICAgIH0pCiAgICAgICAgICAKICAgICAgICAgIH0sCiAgICAgICAgICAgIAoKCgovLyBGVU5DScOTTiBQQVJBIEdVQVJEQVIgTE9TIENBTUJJT1MKICAgICAgY29uZmlybUVkaXRVc2VyKCkgewogICAgICBjb25zdCBzZWxmID0gdGhpczsKICAgICAgLy9UZW5nbyBsYSBhdXRlbnRpY2FjacOzbi4uLgogICAgICBjb25zdCBkYXRhID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oImlkIik7CiAgICAgIGNvbnN0IHRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oInRva2VuIik7CiAgICAgIGF4aW9zLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWyJBdXRob3JpemF0aW9uIl0gPSBgQmVhcmVyICR7dG9rZW59YDsKICAgICAgLy9IYWdvIGxhIHBldGljacOzbiBhIHNlcnZpZG9yCiAgICAgIGF4aW9zCiAgICAgICAgLnB1dCgiaHR0cDovL2xvY2FsaG9zdDozMDAzL3VzdWFyaW9zL2VkaXRhci8iICsgZGF0YSwgewogICAgICAgICAgbm9tYnJlOiBzZWxmLm51ZXZvTm9tYnJlLAogICAgICAgICAgYXBlbGxpZG9zOiBzZWxmLm51ZXZvQXBlbGxpZG8sCiAgICAgICAgICBkZXNjcmlwY2lvbjogc2VsZi5udWV2YURlc2NyaXBjaW9uLAogICAgICAgICAgdXJsX2ZvdG86IHNlbGYuZGF0YS51cmxfZm90bywgCiAgICAgICAgICAKICAgICAgICB9KQogICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICBzZWxmLnNlZUVkaXRhYmxlID0gdHJ1ZTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnJvcikgewogICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvci5yZXNwb25zZS5kYXRhLm1lc3NhZ2UpOyAKICAgICAgICB9KTsKICAgIH0sCiAgICAKCgogICAgc2hvd0VkaXRhYmxlKCkgewogICAgICAgIAogICAgICB0aGlzLnNlZUVkaXRhYmxlID0gdHJ1ZTsKICAgICAgdGhpcy5udWV2b05vbWJyZSA9IHRoaXMudXNlci5ub21icmU7CiAgICAgIHRoaXMubnVldm9BcGVsbGlkbyA9IHRoaXMudXNlci5hcGVsbGlkb3M7CiAgICAgIHRoaXMubnVldmFEZXNjcmlwY2lvbj0gdGhpcy51c2VyLmRlc2NyaXBjaW9uOwogICAgICB0aGlzLnVybF9mb3RvPSB0aGlzLnVzZXIudXJsX2ZvdG87IAogICAgICBjb25zb2xlLmxvZyh0aGlzLnVzZXIubm9tYnJlKTsKICAgIH0sCgoKCiAgICBzZWVIaXN0b3J5KCl7CgoKICAgICAgICBjb25zdCBzZWxmID0gdGhpczsKICAgICAgICAgICAgLy8gQ29qbyB0b2tlbiBlIGlkLgogICAgICAgICAgICBjb25zdCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpOwogICAgICAgICAgICBjb25zdCBkYXRhID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oImlkIik7CiAgICAgICAgICAgIGF4aW9zLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWyJBdXRob3JpemF0aW9uIl0gPSBgQmVhcmVyICR7dG9rZW59YDsKICAgICAgICAgICAKICAgICAgICAgICAgY29uc29sZS5sb2codG9rZW4pOwogICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTsKCiAgICAgICAgICAgIC8vIFBldGljacOzbiBnZXQgYSBtaSBydXRhIGRlbCBCYWNrIHBhcmEgY29uc3VsdGFyIGluc2NyaXBjaW9uZXMsIGNvbmNhdGVuYW1vcyBlbCBpZC4KICAgICAgICAgICAgYXhpb3MuZ2V0KCJodHRwOi8vbG9jYWxob3N0OjMwMDMvdXN1YXJpb3MvaGlzdG9yaWFsLyIgKyBkYXRhKQogICAgICAgICAgICAKICAgICAgICAgICAgLnRoZW4gKGZ1bmN0aW9uIChyZXNwb25zZSl7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIEVuIHVzZXIgdGVuZ28gYWhvcmEgZWwgYWNjZXNvIGRpcmVjdG8gYSBlc3RlIHVzdWFyaW8gY29uY3JldG8uCiAgICAgICAgICAgICAgIHNlbGYuaGlzdG9yaWFsID0gcmVzcG9uc2UuZGF0YS5kYXRhOwogICAgICAgICAgICAgIAogICAgICAgICAgICB9KQogICAgICAgICAgICAgCiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnJvcikgewogICAgICAgICAgICAgYWxlcnQoIlNvY29ycmkiKTsKICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IucmVzcG9uc2UuZGF0YS5tZXNzYWdlKTsgCiAgICAgICAgICAgIAogICAgICAgICAgfSkKICAgICAgICAgIAogICAgICAgICAgfSwKICAgICAgICAgICAgCgoKICAgIH0sCgoKICAKCiAgICAgIGNyZWF0ZWQoKXsKICAgICAgICAgIHRoaXMuZ2V0RGF0YVVzZXIoKTsKICAgICAgICAgIHRoaXMuc2VlSGlzdG9yeSgpOwogICAgICB9CiAgICB9OwogICAgCiAgICAKCiAgICAgICAgCiAgICAKCgo="},{"version":3,"sources":["Profile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;;;AAIA;;;;;AAKA;AACA;AACA;AACA;AACA","file":"Profile.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <!-- Definimos el título de página visible en navegador -->\n    <vue-headful title=\"Profile\" description=\"Tu perfil\" />\n\n    <!-- Inserción del componente menú en la cabecera de la vista -->\n    <menucustom></menucustom>\n\n    <!--Sección de datos personales -->\n    <div class=\"informacionusuario\">\n      <h3>Hola {{ user.nombre }}</h3>\n      <img :src=\"user.url_foto\" alt=\"Foto de perfil de usuario\" />\n      <p>Miembro desde {{user.fecha_registro}}</p>\n      <p>Miembro con rol de: {{ user.rol}}</p>\n    </div>\n\n    <div v-show=\"!seeEditable\">\n      <div class=\"datosparaeditar\">\n        <p class=\"nombre\">{{ user.nombre }}</p>\n        <p class=\"apellidos\">{{ user.apellidos }}</p>\n        <!--  <p class=\"url_foto\">{{ user.url_foto }}</p> -->\n        <p class=\"descripcion\">{{ user.descripcion }}</p>\n      </div>\n    </div>\n\n    <button @click=\"showEditable()\">Actualiza tu perfil</button>\n\n    <hr />\n    <!-- <button @click=\"seeHistory()\">Ver historial de inscripciones</button> -->\n    <div class=\"historialConcurso\">\n      <h3>Historial de concursos</h3>\n      <ul v-for=\"historia in historial\" :key=\"historia.id\">\n        <li>{{ historia.nombre_concurso }}</li>\n        <li>{{ historia.descripcion }}</li>\n        <li>{{ historia.fecha_inicio }}</li>\n        <li>{{ historia.fecha_final }}</li>\n        <li>--------------------------------------------------</li>\n      </ul>\n    </div>\n\n    <div class=\"editar\" v-show=\"seeEditable\">\n      <label for=\"nombre\">Tu nombre:</label>\n      <input type=\"text\" id=\"nombre\" name=\"nombre\" v-model=\"nuevoNombre\" placeholder=\"nombre\" />\n      <br />\n      <label for=\"apellidos\">Tus apellidos:</label>\n      <input\n        type=\"text\"\n        id=\"apellidos\"\n        name=\"apellidos\"\n        v-model=\"nuevoApellido\"\n        placeholder=\"apellidos\"\n      />\n      <br />\n      <label for=\"file\">Selecciona tu nueva foto:</label>\n      <input type=\"file\" id=\"file\" name=\"file\" />\n      <br />\n      <label for=\"descripcion\">Sobre ti:</label>\n      <input\n        type=\"text\"\n        id=\"descripcion\"\n        name=\"descripcion\"\n        v-model=\"nuevaDescripcion\"\n        placeholder=\"descripcion\"\n      />\n      <br />\n      <br />\n      <button @click=\"confirmEditUser()\">Guardar</button>\n      <hr />\n    </div>\n  </div>\n</template>\n\n<script>\n//EXPORTAMOS PARA\n//Manejar títulos de página en pestaña navegador\nimport vueHeadful from \"vue-headful\"\n// Manejo de endpoints, peticiones, rutas:\nimport axios from \"axios\";\n// Componentes internos\nimport menucustom from \"@/components/MenuCustom.vue\"\n\n\nexport default {\n    name: \"Profile\",\n    // Componentes de la vista\n    components: { menucustom, vueHeadful},\n    data(){\n        \n        return{\n            // Declaración de variables que voy a utilizar para recoger la información\n            id: null,\n            user:{},\n            nuevoNombre: \"\",\n            nuevoApellido: \"\",\n            nuevaDescripcion:\"\",\n            // Booleano para controlar el v-show que contiene el formulario de edición.\n            seeEditable: false,\n            url_foto:\"\", \n            historial:[],\n            concursos:[],\n\n        }\n    },\n\n\n    methods: { \n\n        // FUNCIÓN PARA HACER LA PETICIÓN AL SERVIDOR.\n\n        getDataUser(){\n            const self = this;\n            // Cojo token e id.\n            const token = localStorage.getItem(\"token\");\n            const data = localStorage.getItem(\"id\");\n            axios.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\n           \n            console.log(token);\n            console.log(data);\n\n            // Petición get a mi ruta del Back para editar usuarios, concatenamos el id.\n            axios.get(\"http://localhost:3003/usuarios/\" + data)\n            \n            .then (function (response){\n              self.historial = response.data.data;\n                console.log(response);\n                \n                // En user tengo ahora el acceso directo a este usuario concreto.\n               self.user = response.data.data;\n               // Monto la ruta para poder visualizar la imagen que está en la BBDD con un nombre de archivo.\n               self.user.url_foto= \"http://localhost:3003/images/\" + self.user.url_foto;\n               console.log(self.user.url_foto);\n            })\n             \n            .catch(function(error) {\n             alert(\"Socorri\");\n            console.log(error.response.data.message); \n            \n          })\n          \n          },\n            \n\n\n\n// FUNCIÓN PARA GUARDAR LOS CAMBIOS\n      confirmEditUser() {\n      const self = this;\n      //Tengo la autenticación...\n      const data = localStorage.getItem(\"id\");\n      const token = localStorage.getItem(\"token\");\n      axios.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\n      //Hago la petición a servidor\n      axios\n        .put(\"http://localhost:3003/usuarios/editar/\" + data, {\n          nombre: self.nuevoNombre,\n          apellidos: self.nuevoApellido,\n          descripcion: self.nuevaDescripcion,\n          url_foto: self.data.url_foto, \n          \n        })\n        .then(function(response) {\n          self.seeEditable = true;\n        })\n        .catch(function(error) {\n          console.error(error);\n          console.log(error.response.data.message); \n        });\n    },\n    \n\n\n    showEditable() {\n        \n      this.seeEditable = true;\n      this.nuevoNombre = this.user.nombre;\n      this.nuevoApellido = this.user.apellidos;\n      this.nuevaDescripcion= this.user.descripcion;\n      this.url_foto= this.user.url_foto; \n      console.log(this.user.nombre);\n    },\n\n\n\n    seeHistory(){\n\n\n        const self = this;\n            // Cojo token e id.\n            const token = localStorage.getItem(\"token\");\n            const data = localStorage.getItem(\"id\");\n            axios.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\n           \n            console.log(token);\n            console.log(data);\n\n            // Petición get a mi ruta del Back para consultar inscripciones, concatenamos el id.\n            axios.get(\"http://localhost:3003/usuarios/historial/\" + data)\n            \n            .then (function (response){\n                console.log(response);\n                \n                // En user tengo ahora el acceso directo a este usuario concreto.\n               self.historial = response.data.data;\n              \n            })\n             \n            .catch(function(error) {\n             alert(\"Socorri\");\n            console.log(error.response.data.message); \n            \n          })\n          \n          },\n            \n\n\n    },\n\n\n  \n\n      created(){\n          this.getDataUser();\n          this.seeHistory();\n      }\n    };\n    \n    \n\n        \n    \n\n\n</script>\n\n<style>\n</style>"]}]}