{"remainingRequest":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/src/views/Profile.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/src/views/Profile.vue","mtime":1592851904847},{"path":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIEVYUE9SVEFNT1MgUEFSQQovLyBJbmNsdWlyIHZhbG9yYWNpb25lcyBtZWRpYW50ZSBlc3RyZWxsaXRhcwppbXBvcnQgU3RhclJhdGluZyBmcm9tICJ2dWUtc3Rhci1yYXRpbmciCi8vIE1hbmVqYXIgdMOtdHVsb3MgZGUgcMOhZ2luYSBlbiBwZXN0YcOxYSBuYXZlZ2Fkb3IKaW1wb3J0IHZ1ZUhlYWRmdWwgZnJvbSAidnVlLWhlYWRmdWwiCi8vIE1hbmVqbyBkZSBlbmRwb2ludHMsIHBldGljaW9uZXMsIHJ1dGFzOgppbXBvcnQgYXhpb3MgZnJvbSAiYXhpb3MiOwovLyBDb21wb25lbnRlcyBpbnRlcm5vcwppbXBvcnQgbWVudWN1c3RvbSBmcm9tICJAL2NvbXBvbmVudHMvTWVudUN1c3RvbS52dWUiCgoKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogIlByb2ZpbGUiLAogICAgLy8gQ29tcG9uZW50ZXMgZGUgbGEgdmlzdGEKICAgIGNvbXBvbmVudHM6IHsgbWVudWN1c3RvbSwgdnVlSGVhZGZ1bCwgU3RhclJhdGluZ30sCiAgICBkYXRhKCl7CiAgICAgICAgCiAgICAgICAgcmV0dXJuewogICAgICAgICAgICAvLyBEZWNsYXJhY2nDs24gZGUgdmFyaWFibGVzIHF1ZSB2b3kgYSB1dGlsaXphciBwYXJhIHJlY29nZXIgbGEgaW5mb3JtYWNpw7NuCiAgICAgICAgICAgIGlkOiBudWxsLAogICAgICAgICAgICB1c2VyOnt9LAogICAgICAgICAgICBudWV2b05vbWJyZTogIiIsCiAgICAgICAgICAgIG51ZXZvQXBlbGxpZG86ICIiLAogICAgICAgICAgICBudWV2YURlc2NyaXBjaW9uOiIiLAogICAgICAgICAgICAvLyBCb29sZWFubyBwYXJhIGNvbnRyb2xhciBlbCB2LXNob3cgcXVlIGNvbnRpZW5lIGVsIGZvcm11bGFyaW8gZGUgZWRpY2nDs24uCiAgICAgICAgICAgIHNlZUVkaXRhYmxlOiBmYWxzZSwKICAgICAgICAgICAgdXJsX2ZvdG86IiIsIAogICAgICAgICAgICBoaXN0b3JpYWw6W10sCiAgICAgICAgICAgIGNvbmN1cnNvczpbXSwKICAgICAgICAgICAgcmF0aW5nOiAwCgogICAgICAgIH0KICAgIH0sCgoKICAgIG1ldGhvZHM6IHsgCgogICAgICAgIC8vIEZVTkNJw5NOIFBBUkEgSEFDRVIgTEEgUEVUSUNJw5NOIEFMIFNFUlZJRE9SLgoKICAgICAgICBnZXREYXRhVXNlcigpewogICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpczsKICAgICAgICAgICAgLy8gQ29qbyB0b2tlbiBlIGlkLgogICAgICAgICAgICBjb25zdCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpOwogICAgICAgICAgICBjb25zdCBkYXRhID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oImlkIik7CiAgICAgICAgICAgIGF4aW9zLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWyJBdXRob3JpemF0aW9uIl0gPSBgQmVhcmVyICR7dG9rZW59YDsKICAgICAgICAgICAKICAgICAgICAgICAgY29uc29sZS5sb2codG9rZW4pOwogICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTsKCiAgICAgICAgICAgIC8vIFBldGljacOzbiBnZXQgYSBtaSBydXRhIGRlbCBCYWNrIHBhcmEgZWRpdGFyIHVzdWFyaW9zLCBjb25jYXRlbmFtb3MgZWwgaWQuCiAgICAgICAgICAgIGF4aW9zLmdldCgiaHR0cDovL2xvY2FsaG9zdDozMDAzL3VzdWFyaW9zLyIgKyBkYXRhKQogICAgICAgICAgICAKICAgICAgICAgICAgLnRoZW4gKGZ1bmN0aW9uIChyZXNwb25zZSl7CiAgICAgICAgICAgICAgc2VsZi5oaXN0b3JpYWwgPSByZXNwb25zZS5kYXRhLmRhdGE7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIEVuIHVzZXIgdGVuZ28gYWhvcmEgZWwgYWNjZXNvIGRpcmVjdG8gYSBlc3RlIHVzdWFyaW8gY29uY3JldG8uCiAgICAgICAgICAgICAgIHNlbGYudXNlciA9IHJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICAgICAgICAgLy8gTW9udG8gbGEgcnV0YSBwYXJhIHBvZGVyIHZpc3VhbGl6YXIgbGEgaW1hZ2VuIHF1ZSBlc3TDoSBlbiBsYSBCQkREIGNvbiB1biBub21icmUgZGUgYXJjaGl2by4KICAgICAgICAgICAgICAgc2VsZi51c2VyLnVybF9mb3RvPSAiaHR0cDovL2xvY2FsaG9zdDozMDAzL2ltYWdlcy8iICsgc2VsZi51c2VyLnVybF9mb3RvOwogICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzZWxmLnVzZXIudXJsX2ZvdG8pOwogICAgICAgICAgICB9KQogICAgICAgICAgICAgCiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnJvcikgewogICAgICAgICAgICAgYWxlcnQoIlNvY29ycmkiKTsKICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IucmVzcG9uc2UuZGF0YS5tZXNzYWdlKTsgCiAgICAgICAgICAgIAogICAgICAgICAgfSkKICAgICAgICAgIAogICAgICAgICAgfSwKICAgICAgICAgICAgCgoKCi8vIEZVTkNJw5NOIFBBUkEgR1VBUkRBUiBMT1MgQ0FNQklPUwogICAgICBjb25maXJtRWRpdFVzZXIoKSB7CiAgICAgIGNvbnN0IHNlbGYgPSB0aGlzOwogICAgICAvL1RlbmdvIGxhIGF1dGVudGljYWNpw7NuLi4uCiAgICAgIGNvbnN0IGRhdGEgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiaWQiKTsKICAgICAgY29uc3QgdG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidG9rZW4iKTsKICAgICAgYXhpb3MuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bIkF1dGhvcml6YXRpb24iXSA9IGBCZWFyZXIgJHt0b2tlbn1gOwogICAgICAvL0hhZ28gbGEgcGV0aWNpw7NuIGEgc2Vydmlkb3IKICAgICAgYXhpb3MKICAgICAgICAucHV0KCJodHRwOi8vbG9jYWxob3N0OjMwMDMvdXN1YXJpb3MvZWRpdGFyLyIgKyBkYXRhLCB7CiAgICAgICAgICBub21icmU6IHNlbGYubnVldm9Ob21icmUsCiAgICAgICAgICBhcGVsbGlkb3M6IHNlbGYubnVldm9BcGVsbGlkbywKICAgICAgICAgIGRlc2NyaXBjaW9uOiBzZWxmLm51ZXZhRGVzY3JpcGNpb24sCiAgICAgICAgICB1cmxfZm90bzogc2VsZi5kYXRhLnVybF9mb3RvLCAKICAgICAgICAgIAogICAgICAgIH0pCiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICAgIHNlbGYuc2VlRWRpdGFibGUgPSB0cnVlOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yLnJlc3BvbnNlLmRhdGEubWVzc2FnZSk7IAogICAgICAgIH0pOwogICAgfSwKICAgIAoKCiAgICBzaG93RWRpdGFibGUoKSB7CiAgICAgICAgCiAgICAgIHRoaXMuc2VlRWRpdGFibGUgPSB0cnVlOwogICAgICB0aGlzLm51ZXZvTm9tYnJlID0gdGhpcy51c2VyLm5vbWJyZTsKICAgICAgdGhpcy5udWV2b0FwZWxsaWRvID0gdGhpcy51c2VyLmFwZWxsaWRvczsKICAgICAgdGhpcy5udWV2YURlc2NyaXBjaW9uPSB0aGlzLnVzZXIuZGVzY3JpcGNpb247CiAgICAgIHRoaXMudXJsX2ZvdG89IHRoaXMudXNlci51cmxfZm90bzsgCiAgICAgIGNvbnNvbGUubG9nKHRoaXMudXNlci5ub21icmUpOwogICAgfSwKCgoKICAgIHNlZUhpc3RvcnkoKXsKCgogICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzOwogICAgICAgICAgICAvLyBDb2pvIHRva2VuIGUgaWQuCiAgICAgICAgICAgIGNvbnN0IHRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oInRva2VuIik7CiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiaWQiKTsKICAgICAgICAgICAgYXhpb3MuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bIkF1dGhvcml6YXRpb24iXSA9IGBCZWFyZXIgJHt0b2tlbn1gOwogICAgICAgICAgIAogICAgICAgICAgICBjb25zb2xlLmxvZyh0b2tlbik7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpOwoKICAgICAgICAgICAgLy8gUGV0aWNpw7NuIGdldCBhIG1pIHJ1dGEgZGVsIEJhY2sgcGFyYSBjb25zdWx0YXIgaW5zY3JpcGNpb25lcywgY29uY2F0ZW5hbW9zIGVsIGlkLgogICAgICAgICAgICBheGlvcy5nZXQoImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMy91c3Vhcmlvcy9oaXN0b3JpYWwvIiArIGRhdGEpCiAgICAgICAgICAgIAogICAgICAgICAgICAudGhlbiAoZnVuY3Rpb24gKHJlc3BvbnNlKXsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gRW4gdXNlciB0ZW5nbyBhaG9yYSBlbCBhY2Nlc28gZGlyZWN0byBhIGVzdGUgdXN1YXJpbyBjb25jcmV0by4KICAgICAgICAgICAgICAgc2VsZi5oaXN0b3JpYWwgPSByZXNwb25zZS5kYXRhLmRhdGE7CiAgICAgICAgICAgICAgCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAKICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7CiAgICAgICAgICAgICBhbGVydCgiU29jb3JyaSIpOwogICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvci5yZXNwb25zZS5kYXRhLm1lc3NhZ2UpOyAKICAgICAgICAgICAgCiAgICAgICAgICB9KQogICAgICAgICAgCiAgICAgICAgICB9LAogICAgICAgICAgICAKCgogICAgfSwKCgogIAoKICAgICAgY3JlYXRlZCgpewogICAgICAgICAgdGhpcy5nZXREYXRhVXNlcigpOwogICAgICAgICAgdGhpcy5zZWVIaXN0b3J5KCk7CiAgICAgIH0KICAgIH07CiAgICAKICAgIAoKICAgICAgICAKICAgIAoKCg=="},{"version":3,"sources":["Profile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;;;AAIA;;;;;AAKA;AACA;AACA;AACA;AACA","file":"Profile.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <!-- Definimos el título de página visible en navegador -->\n    <vue-headful title=\"Profile\" description=\"Tu perfil\" />\n\n    <!-- Inserción del componente menú en la cabecera de la vista -->\n    <menucustom></menucustom>\n\n    <!--Sección de datos personales -->\n    <div class=\"informacionusuario\">\n      <h3>Hola {{ user.nombre }}</h3>\n      <img :src=\"user.url_foto\" alt=\"Foto de perfil de usuario\" />\n      <p>Miembro desde {{user.fecha_registro.slice(0,10)}}</p>\n      <p>Miembro con rol de: {{ user.rol}}</p>\n    </div>\n\n    <div v-show=\"!seeEditable\">\n      <div class=\"datosparaeditar\">\n        <p class=\"nombre\">{{ user.nombre }}</p>\n        <p class=\"apellidos\">{{ user.apellidos }}</p>\n        <!--  <p class=\"url_foto\">{{ user.url_foto }}</p> -->\n        <p class=\"descripcion\">{{ user.descripcion }}</p>\n      </div>\n    </div>\n\n    <button @click=\"showEditable()\">Actualiza tu perfil</button>\n\n    <hr />\n    <!-- <button @click=\"seeHistory()\">Ver historial de inscripciones</button> -->\n    <div class=\"historialConcurso\">\n      <h3>Historial de concursos</h3>\n      <ul v-for=\"historia in historial\" :key=\"historia.id\">\n        <li>{{ historia.nombre_concurso }}</li>\n        <li>{{ historia.descripcion }}</li>\n        <li>{{ historia.fecha_inicio.slice(0,10) }}</li>\n        <li>{{ historia.fecha_final.slice(0,10) }}</li>\n        <star-rating v-model\"rating\"></star-rating>\n        <li>--------------------------------------------------</li>\n      </ul>\n    </div>\n\n    <div class=\"editar\" v-show=\"seeEditable\">\n      <label for=\"nombre\">Tu nombre:</label>\n      <input type=\"text\" id=\"nombre\" name=\"nombre\" v-model=\"nuevoNombre\" placeholder=\"nombre\" />\n      <br />\n      <label for=\"apellidos\">Tus apellidos:</label>\n      <input\n        type=\"text\"\n        id=\"apellidos\"\n        name=\"apellidos\"\n        v-model=\"nuevoApellido\"\n        placeholder=\"apellidos\"\n      />\n      <br />\n      <label for=\"file\">Selecciona tu nueva foto:</label>\n      <input type=\"file\" id=\"file\" name=\"file\" />\n      <br />\n      <label for=\"descripcion\">Sobre ti:</label>\n      <input\n        type=\"text\"\n        id=\"descripcion\"\n        name=\"descripcion\"\n        v-model=\"nuevaDescripcion\"\n        placeholder=\"descripcion\"\n      />\n      <br />\n      <br />\n      <button @click=\"confirmEditUser()\">Guardar</button>\n      <hr />\n    </div>\n  </div>\n</template>\n\n<script>\n// EXPORTAMOS PARA\n// Incluir valoraciones mediante estrellitas\nimport StarRating from \"vue-star-rating\"\n// Manejar títulos de página en pestaña navegador\nimport vueHeadful from \"vue-headful\"\n// Manejo de endpoints, peticiones, rutas:\nimport axios from \"axios\";\n// Componentes internos\nimport menucustom from \"@/components/MenuCustom.vue\"\n\n\nexport default {\n    name: \"Profile\",\n    // Componentes de la vista\n    components: { menucustom, vueHeadful, StarRating},\n    data(){\n        \n        return{\n            // Declaración de variables que voy a utilizar para recoger la información\n            id: null,\n            user:{},\n            nuevoNombre: \"\",\n            nuevoApellido: \"\",\n            nuevaDescripcion:\"\",\n            // Booleano para controlar el v-show que contiene el formulario de edición.\n            seeEditable: false,\n            url_foto:\"\", \n            historial:[],\n            concursos:[],\n            rating: 0\n\n        }\n    },\n\n\n    methods: { \n\n        // FUNCIÓN PARA HACER LA PETICIÓN AL SERVIDOR.\n\n        getDataUser(){\n            const self = this;\n            // Cojo token e id.\n            const token = localStorage.getItem(\"token\");\n            const data = localStorage.getItem(\"id\");\n            axios.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\n           \n            console.log(token);\n            console.log(data);\n\n            // Petición get a mi ruta del Back para editar usuarios, concatenamos el id.\n            axios.get(\"http://localhost:3003/usuarios/\" + data)\n            \n            .then (function (response){\n              self.historial = response.data.data;\n                console.log(response);\n                \n                // En user tengo ahora el acceso directo a este usuario concreto.\n               self.user = response.data.data;\n               // Monto la ruta para poder visualizar la imagen que está en la BBDD con un nombre de archivo.\n               self.user.url_foto= \"http://localhost:3003/images/\" + self.user.url_foto;\n               console.log(self.user.url_foto);\n            })\n             \n            .catch(function(error) {\n             alert(\"Socorri\");\n            console.log(error.response.data.message); \n            \n          })\n          \n          },\n            \n\n\n\n// FUNCIÓN PARA GUARDAR LOS CAMBIOS\n      confirmEditUser() {\n      const self = this;\n      //Tengo la autenticación...\n      const data = localStorage.getItem(\"id\");\n      const token = localStorage.getItem(\"token\");\n      axios.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\n      //Hago la petición a servidor\n      axios\n        .put(\"http://localhost:3003/usuarios/editar/\" + data, {\n          nombre: self.nuevoNombre,\n          apellidos: self.nuevoApellido,\n          descripcion: self.nuevaDescripcion,\n          url_foto: self.data.url_foto, \n          \n        })\n        .then(function(response) {\n          self.seeEditable = true;\n        })\n        .catch(function(error) {\n          console.error(error);\n          console.log(error.response.data.message); \n        });\n    },\n    \n\n\n    showEditable() {\n        \n      this.seeEditable = true;\n      this.nuevoNombre = this.user.nombre;\n      this.nuevoApellido = this.user.apellidos;\n      this.nuevaDescripcion= this.user.descripcion;\n      this.url_foto= this.user.url_foto; \n      console.log(this.user.nombre);\n    },\n\n\n\n    seeHistory(){\n\n\n        const self = this;\n            // Cojo token e id.\n            const token = localStorage.getItem(\"token\");\n            const data = localStorage.getItem(\"id\");\n            axios.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\n           \n            console.log(token);\n            console.log(data);\n\n            // Petición get a mi ruta del Back para consultar inscripciones, concatenamos el id.\n            axios.get(\"http://localhost:3003/usuarios/historial/\" + data)\n            \n            .then (function (response){\n                console.log(response);\n                \n                // En user tengo ahora el acceso directo a este usuario concreto.\n               self.historial = response.data.data;\n              \n            })\n             \n            .catch(function(error) {\n             alert(\"Socorri\");\n            console.log(error.response.data.message); \n            \n          })\n          \n          },\n            \n\n\n    },\n\n\n  \n\n      created(){\n          this.getDataUser();\n          this.seeHistory();\n      }\n    };\n    \n    \n\n        \n    \n\n\n</script>\n\n<style>\n</style>"]}]}