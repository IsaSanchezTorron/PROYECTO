{"remainingRequest":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/src/views/Profile.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/src/views/Profile.vue","mtime":1592851927303},{"path":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hab07/Desktop/Repo-Proyecto/PROYECTO/Frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIEVYUE9SVEFNT1MgUEFSQQovLyBJbmNsdWlyIHZhbG9yYWNpb25lcyBtZWRpYW50ZSBlc3RyZWxsaXRhcwppbXBvcnQgU3RhclJhdGluZyBmcm9tICJ2dWUtc3Rhci1yYXRpbmciOwovLyBNYW5lamFyIHTDrXR1bG9zIGRlIHDDoWdpbmEgZW4gcGVzdGHDsWEgbmF2ZWdhZG9yCmltcG9ydCB2dWVIZWFkZnVsIGZyb20gInZ1ZS1oZWFkZnVsIjsKLy8gTWFuZWpvIGRlIGVuZHBvaW50cywgcGV0aWNpb25lcywgcnV0YXM6CmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7Ci8vIENvbXBvbmVudGVzIGludGVybm9zCmltcG9ydCBtZW51Y3VzdG9tIGZyb20gIkAvY29tcG9uZW50cy9NZW51Q3VzdG9tLnZ1ZSI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlByb2ZpbGUiLAogIC8vIENvbXBvbmVudGVzIGRlIGxhIHZpc3RhCiAgY29tcG9uZW50czogeyBtZW51Y3VzdG9tLCB2dWVIZWFkZnVsLCBTdGFyUmF0aW5nIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIC8vIERlY2xhcmFjacOzbiBkZSB2YXJpYWJsZXMgcXVlIHZveSBhIHV0aWxpemFyIHBhcmEgcmVjb2dlciBsYSBpbmZvcm1hY2nDs24KICAgICAgaWQ6IG51bGwsCiAgICAgIHVzZXI6IHt9LAogICAgICBudWV2b05vbWJyZTogIiIsCiAgICAgIG51ZXZvQXBlbGxpZG86ICIiLAogICAgICBudWV2YURlc2NyaXBjaW9uOiAiIiwKICAgICAgLy8gQm9vbGVhbm8gcGFyYSBjb250cm9sYXIgZWwgdi1zaG93IHF1ZSBjb250aWVuZSBlbCBmb3JtdWxhcmlvIGRlIGVkaWNpw7NuLgogICAgICBzZWVFZGl0YWJsZTogZmFsc2UsCiAgICAgIHVybF9mb3RvOiAiIiwKICAgICAgaGlzdG9yaWFsOiBbXSwKICAgICAgY29uY3Vyc29zOiBbXSwKICAgICAgcmF0aW5nOiAwLAogICAgfTsKICB9LAoKICBtZXRob2RzOiB7CiAgICAvLyBGVU5DScOTTiBQQVJBIEhBQ0VSIExBIFBFVElDScOTTiBBTCBTRVJWSURPUi4KCiAgICBnZXREYXRhVXNlcigpIHsKICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7CiAgICAgIC8vIENvam8gdG9rZW4gZSBpZC4KICAgICAgY29uc3QgdG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidG9rZW4iKTsKICAgICAgY29uc3QgZGF0YSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJpZCIpOwogICAgICBheGlvcy5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsiQXV0aG9yaXphdGlvbiJdID0gYEJlYXJlciAke3Rva2VufWA7CgogICAgICBjb25zb2xlLmxvZyh0b2tlbik7CiAgICAgIGNvbnNvbGUubG9nKGRhdGEpOwoKICAgICAgLy8gUGV0aWNpw7NuIGdldCBhIG1pIHJ1dGEgZGVsIEJhY2sgcGFyYSBlZGl0YXIgdXN1YXJpb3MsIGNvbmNhdGVuYW1vcyBlbCBpZC4KICAgICAgYXhpb3MKICAgICAgICAuZ2V0KCJodHRwOi8vbG9jYWxob3N0OjMwMDMvdXN1YXJpb3MvIiArIGRhdGEpCgogICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgc2VsZi5oaXN0b3JpYWwgPSByZXNwb25zZS5kYXRhLmRhdGE7CiAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7CgogICAgICAgICAgLy8gRW4gdXNlciB0ZW5nbyBhaG9yYSBlbCBhY2Nlc28gZGlyZWN0byBhIGVzdGUgdXN1YXJpbyBjb25jcmV0by4KICAgICAgICAgIHNlbGYudXNlciA9IHJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICAgIC8vIE1vbnRvIGxhIHJ1dGEgcGFyYSBwb2RlciB2aXN1YWxpemFyIGxhIGltYWdlbiBxdWUgZXN0w6EgZW4gbGEgQkJERCBjb24gdW4gbm9tYnJlIGRlIGFyY2hpdm8uCiAgICAgICAgICBzZWxmLnVzZXIudXJsX2ZvdG8gPQogICAgICAgICAgICAiaHR0cDovL2xvY2FsaG9zdDozMDAzL2ltYWdlcy8iICsgc2VsZi51c2VyLnVybF9mb3RvOwogICAgICAgICAgY29uc29sZS5sb2coc2VsZi51c2VyLnVybF9mb3RvKTsKICAgICAgICB9KQoKICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICBhbGVydCgiU29jb3JyaSIpOwogICAgICAgICAgY29uc29sZS5sb2coZXJyb3IucmVzcG9uc2UuZGF0YS5tZXNzYWdlKTsKICAgICAgICB9KTsKICAgIH0sCgogICAgLy8gRlVOQ0nDk04gUEFSQSBHVUFSREFSIExPUyBDQU1CSU9TCiAgICBjb25maXJtRWRpdFVzZXIoKSB7CiAgICAgIGNvbnN0IHNlbGYgPSB0aGlzOwogICAgICAvL1RlbmdvIGxhIGF1dGVudGljYWNpw7NuLi4uCiAgICAgIGNvbnN0IGRhdGEgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiaWQiKTsKICAgICAgY29uc3QgdG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidG9rZW4iKTsKICAgICAgYXhpb3MuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bIkF1dGhvcml6YXRpb24iXSA9IGBCZWFyZXIgJHt0b2tlbn1gOwogICAgICAvL0hhZ28gbGEgcGV0aWNpw7NuIGEgc2Vydmlkb3IKICAgICAgYXhpb3MKICAgICAgICAucHV0KCJodHRwOi8vbG9jYWxob3N0OjMwMDMvdXN1YXJpb3MvZWRpdGFyLyIgKyBkYXRhLCB7CiAgICAgICAgICBub21icmU6IHNlbGYubnVldm9Ob21icmUsCiAgICAgICAgICBhcGVsbGlkb3M6IHNlbGYubnVldm9BcGVsbGlkbywKICAgICAgICAgIGRlc2NyaXBjaW9uOiBzZWxmLm51ZXZhRGVzY3JpcGNpb24sCiAgICAgICAgICB1cmxfZm90bzogc2VsZi5kYXRhLnVybF9mb3RvLAogICAgICAgIH0pCiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBzZWxmLnNlZUVkaXRhYmxlID0gdHJ1ZTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOwogICAgICAgICAgY29uc29sZS5sb2coZXJyb3IucmVzcG9uc2UuZGF0YS5tZXNzYWdlKTsKICAgICAgICB9KTsKICAgIH0sCgogICAgc2hvd0VkaXRhYmxlKCkgewogICAgICB0aGlzLnNlZUVkaXRhYmxlID0gdHJ1ZTsKICAgICAgdGhpcy5udWV2b05vbWJyZSA9IHRoaXMudXNlci5ub21icmU7CiAgICAgIHRoaXMubnVldm9BcGVsbGlkbyA9IHRoaXMudXNlci5hcGVsbGlkb3M7CiAgICAgIHRoaXMubnVldmFEZXNjcmlwY2lvbiA9IHRoaXMudXNlci5kZXNjcmlwY2lvbjsKICAgICAgdGhpcy51cmxfZm90byA9IHRoaXMudXNlci51cmxfZm90bzsKICAgICAgY29uc29sZS5sb2codGhpcy51c2VyLm5vbWJyZSk7CiAgICB9LAoKICAgIHNlZUhpc3RvcnkoKSB7CiAgICAgIGNvbnN0IHNlbGYgPSB0aGlzOwogICAgICAvLyBDb2pvIHRva2VuIGUgaWQuCiAgICAgIGNvbnN0IHRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oInRva2VuIik7CiAgICAgIGNvbnN0IGRhdGEgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiaWQiKTsKICAgICAgYXhpb3MuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bIkF1dGhvcml6YXRpb24iXSA9IGBCZWFyZXIgJHt0b2tlbn1gOwoKICAgICAgY29uc29sZS5sb2codG9rZW4pOwogICAgICBjb25zb2xlLmxvZyhkYXRhKTsKCiAgICAgIC8vIFBldGljacOzbiBnZXQgYSBtaSBydXRhIGRlbCBCYWNrIHBhcmEgY29uc3VsdGFyIGluc2NyaXBjaW9uZXMsIGNvbmNhdGVuYW1vcyBlbCBpZC4KICAgICAgYXhpb3MKICAgICAgICAuZ2V0KCJodHRwOi8vbG9jYWxob3N0OjMwMDMvdXN1YXJpb3MvaGlzdG9yaWFsLyIgKyBkYXRhKQoKICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKCiAgICAgICAgICAvLyBFbiB1c2VyIHRlbmdvIGFob3JhIGVsIGFjY2VzbyBkaXJlY3RvIGEgZXN0ZSB1c3VhcmlvIGNvbmNyZXRvLgogICAgICAgICAgc2VsZi5oaXN0b3JpYWwgPSByZXNwb25zZS5kYXRhLmRhdGE7CiAgICAgICAgfSkKCiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgYWxlcnQoIlNvY29ycmkiKTsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yLnJlc3BvbnNlLmRhdGEubWVzc2FnZSk7CiAgICAgICAgfSk7CiAgICB9LAogIH0sCgogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldERhdGFVc2VyKCk7CiAgICB0aGlzLnNlZUhpc3RvcnkoKTsKICB9LAp9Owo="},{"version":3,"sources":["Profile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"Profile.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <!-- Definimos el título de página visible en navegador -->\n    <vue-headful title=\"Profile\" description=\"Tu perfil\" />\n\n    <!-- Inserción del componente menú en la cabecera de la vista -->\n    <menucustom></menucustom>\n\n    <!--Sección de datos personales -->\n    <div class=\"informacionusuario\">\n      <h3>Hola {{ user.nombre }}</h3>\n      <img :src=\"user.url_foto\" alt=\"Foto de perfil de usuario\" />\n      <p>Miembro desde {{ user.fecha_registro.slice(0, 10) }}</p>\n      <p>Miembro con rol de: {{ user.rol }}</p>\n    </div>\n\n    <div v-show=\"!seeEditable\">\n      <div class=\"datosparaeditar\">\n        <p class=\"nombre\">{{ user.nombre }}</p>\n        <p class=\"apellidos\">{{ user.apellidos }}</p>\n        <!--  <p class=\"url_foto\">{{ user.url_foto }}</p> -->\n        <p class=\"descripcion\">{{ user.descripcion }}</p>\n      </div>\n    </div>\n\n    <button @click=\"showEditable()\">Actualiza tu perfil</button>\n\n    <hr />\n    <!-- <button @click=\"seeHistory()\">Ver historial de inscripciones</button> -->\n    <div class=\"historialConcurso\">\n      <h3>Historial de concursos</h3>\n      <ul v-for=\"historia in historial\" :key=\"historia.id\">\n        <li>{{ historia.nombre_concurso }}</li>\n        <li>{{ historia.descripcion }}</li>\n        <li>{{ historia.fecha_inicio.slice(0, 10) }}</li>\n        <li>{{ historia.fecha_final.slice(0, 10) }}</li>\n        <star-rating v-model=\"rating\"></star-rating>\n        <li>--------------------------------------------------</li>\n      </ul>\n    </div>\n\n    <div class=\"editar\" v-show=\"seeEditable\">\n      <label for=\"nombre\">Tu nombre:</label>\n      <input\n        type=\"text\"\n        id=\"nombre\"\n        name=\"nombre\"\n        v-model=\"nuevoNombre\"\n        placeholder=\"nombre\"\n      />\n      <br />\n      <label for=\"apellidos\">Tus apellidos:</label>\n      <input\n        type=\"text\"\n        id=\"apellidos\"\n        name=\"apellidos\"\n        v-model=\"nuevoApellido\"\n        placeholder=\"apellidos\"\n      />\n      <br />\n      <label for=\"file\">Selecciona tu nueva foto:</label>\n      <input type=\"file\" id=\"file\" name=\"file\" />\n      <br />\n      <label for=\"descripcion\">Sobre ti:</label>\n      <input\n        type=\"text\"\n        id=\"descripcion\"\n        name=\"descripcion\"\n        v-model=\"nuevaDescripcion\"\n        placeholder=\"descripcion\"\n      />\n      <br />\n      <br />\n      <button @click=\"confirmEditUser()\">Guardar</button>\n      <hr />\n    </div>\n  </div>\n</template>\n\n<script>\n// EXPORTAMOS PARA\n// Incluir valoraciones mediante estrellitas\nimport StarRating from \"vue-star-rating\";\n// Manejar títulos de página en pestaña navegador\nimport vueHeadful from \"vue-headful\";\n// Manejo de endpoints, peticiones, rutas:\nimport axios from \"axios\";\n// Componentes internos\nimport menucustom from \"@/components/MenuCustom.vue\";\n\nexport default {\n  name: \"Profile\",\n  // Componentes de la vista\n  components: { menucustom, vueHeadful, StarRating },\n  data() {\n    return {\n      // Declaración de variables que voy a utilizar para recoger la información\n      id: null,\n      user: {},\n      nuevoNombre: \"\",\n      nuevoApellido: \"\",\n      nuevaDescripcion: \"\",\n      // Booleano para controlar el v-show que contiene el formulario de edición.\n      seeEditable: false,\n      url_foto: \"\",\n      historial: [],\n      concursos: [],\n      rating: 0,\n    };\n  },\n\n  methods: {\n    // FUNCIÓN PARA HACER LA PETICIÓN AL SERVIDOR.\n\n    getDataUser() {\n      const self = this;\n      // Cojo token e id.\n      const token = localStorage.getItem(\"token\");\n      const data = localStorage.getItem(\"id\");\n      axios.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\n\n      console.log(token);\n      console.log(data);\n\n      // Petición get a mi ruta del Back para editar usuarios, concatenamos el id.\n      axios\n        .get(\"http://localhost:3003/usuarios/\" + data)\n\n        .then(function (response) {\n          self.historial = response.data.data;\n          console.log(response);\n\n          // En user tengo ahora el acceso directo a este usuario concreto.\n          self.user = response.data.data;\n          // Monto la ruta para poder visualizar la imagen que está en la BBDD con un nombre de archivo.\n          self.user.url_foto =\n            \"http://localhost:3003/images/\" + self.user.url_foto;\n          console.log(self.user.url_foto);\n        })\n\n        .catch(function (error) {\n          alert(\"Socorri\");\n          console.log(error.response.data.message);\n        });\n    },\n\n    // FUNCIÓN PARA GUARDAR LOS CAMBIOS\n    confirmEditUser() {\n      const self = this;\n      //Tengo la autenticación...\n      const data = localStorage.getItem(\"id\");\n      const token = localStorage.getItem(\"token\");\n      axios.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\n      //Hago la petición a servidor\n      axios\n        .put(\"http://localhost:3003/usuarios/editar/\" + data, {\n          nombre: self.nuevoNombre,\n          apellidos: self.nuevoApellido,\n          descripcion: self.nuevaDescripcion,\n          url_foto: self.data.url_foto,\n        })\n        .then(function (response) {\n          self.seeEditable = true;\n        })\n        .catch(function (error) {\n          console.error(error);\n          console.log(error.response.data.message);\n        });\n    },\n\n    showEditable() {\n      this.seeEditable = true;\n      this.nuevoNombre = this.user.nombre;\n      this.nuevoApellido = this.user.apellidos;\n      this.nuevaDescripcion = this.user.descripcion;\n      this.url_foto = this.user.url_foto;\n      console.log(this.user.nombre);\n    },\n\n    seeHistory() {\n      const self = this;\n      // Cojo token e id.\n      const token = localStorage.getItem(\"token\");\n      const data = localStorage.getItem(\"id\");\n      axios.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\n\n      console.log(token);\n      console.log(data);\n\n      // Petición get a mi ruta del Back para consultar inscripciones, concatenamos el id.\n      axios\n        .get(\"http://localhost:3003/usuarios/historial/\" + data)\n\n        .then(function (response) {\n          console.log(response);\n\n          // En user tengo ahora el acceso directo a este usuario concreto.\n          self.historial = response.data.data;\n        })\n\n        .catch(function (error) {\n          alert(\"Socorri\");\n          console.log(error.response.data.message);\n        });\n    },\n  },\n\n  created() {\n    this.getDataUser();\n    this.seeHistory();\n  },\n};\n</script>\n\n<style></style>\n"]}]}